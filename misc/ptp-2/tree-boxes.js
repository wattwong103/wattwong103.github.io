function treeBoxes(t,e){function r(t,e){t,t&&t.length>0&&"/"!=t.charAt(t.length-1)&&"/",e?n(e):(console.error(e),alert("Invalides data."))}function n(t){function e(t){t.children&&(t._children=t.children,t._children.forEach(e),t.children=null)}y=d3.layout.tree().size([A,_]),(g=t).fixed=!0;var r=0,n=s(y.nodes(g),function(t){r++,t.forEach(function(t){"type1"==t.type&&(t.color=L),"type2"==t.type&&(t.color=z),"type3"==t.type&&(t.color=T),"type4"==t.type&&(t.color=O)})});A=n*(B.height+20)+Y.height+20-S.right-S.left,_=r*(1.5*B.width)+Y.width/2-S.top-S.bottom,y=d3.layout.tree().size([A,_]),g.x0=A/2,g.y0=0,v=d3.select("#tree-container").append("svg").attr("width",_+S.right+S.left).attr("height",A+S.top+S.bottom).attr("class","svgContainer").call(d3.behavior.zoom().scaleExtent([.1,3]).on("zoom",a)),u(),d3.select("#tree-container").select("svg").on(m,null),d3.select("#tree-container").select("svg").on("dblclick.zoom",null),w=v.append("g").attr("class","drawarea").append("g").attr("transform","translate("+S.left+","+S.top+")"),k=w.append("g").attr("id","nodes"),I=w.append("g").attr("id","links"),D=w.append("g").attr("id","linksTooltips"),b=w.append("g").attr("id","nodesTooltips"),M=v.append("defs"),p(),f(),g.children.forEach(e),i(g)}function i(t){function e(t,e){return"SYNC"==t?e?"url(#start-arrow-selected)":"url(#start-arrow)":""}function r(t){return"SYNC"==t.direction?"Synchronous [\u2194]":"ASYN"==t.direction?"Asynchronous [\u2192]":"???"}var n=y.nodes(g).reverse(),i=y.links(n);s(y.nodes(g),d),n.forEach(function(t){t.y=t.depth*(1.5*B.width)});var a=k.selectAll("g.node").data(n,function(t){return t.id||(t.id=++C)}),u=b.selectAll("g").data(n,function(t){return t.id||(t.id=++C)}),f=a.enter().insert("g","g.node").attr("class","node").attr("transform",function(){return"translate("+t.y0+","+t.x0+")"}).on("click",function(t){o(t)}),p=u.enter().append("g").attr("transform",function(){return"translate("+t.y0+","+t.x0+")"});f.append("g").append("rect").attr("rx",6).attr("ry",6).attr("width",B.width).attr("height",B.height).attr("class","node-rect").attr("fill",function(t){return t.color}).attr("filter","url(#drop-shadow)"),f.append("foreignObject").attr("x",B.textMargin).attr("y",B.textMargin).attr("width",function(){return B.width-2*B.textMargin<0?0:B.width-2*B.textMargin}).attr("height",function(){return B.height-2*B.textMargin<0?0:B.height-2*B.textMargin}).append("xhtml").html(function(t){return'<div style="width: '+(B.width-2*B.textMargin)+"px; height: "+(B.height-2*B.textMargin)+'px; font-size: 14px; " class="node-text wordwrap"><b>'+t.nodeName+"</b><br><br><b>Description: </b>"+t.desc+"<br><b>Version: </b>"+t.version+"<br></div>"}).on("mouseover",function(t){$("#nodeInfoID"+t.id).css("visibility","visible"),$("#nodeInfoTextID"+t.id).css("visibility","visible")}).on("mouseout",function(t){$("#nodeInfoID"+t.id).css("visibility","hidden"),$("#nodeInfoTextID"+t.id).css("visibility","hidden")}),f.append("svg:circle").attr("x",function(){return 0}).attr("dy","-.15em").attr("r",.01).style("fill",function(t){return t.children?"black":"#999"}).on("click",function(t){var e=t.url;window.open(e,"_blank")}),p.append("rect").attr("id",function(t){return"nodeInfoID"+t.id}).attr("x",B.width/2).attr("y",B.height/2).attr("width",Y.width).attr("height",Y.height).attr("class","tooltip-box").style("fill-opacity",.8).on("mouseover",function(t){$("#nodeInfoID"+t.id).css("visibility","visible"),$("#nodeInfoTextID"+t.id).css("visibility","visible"),l()}).on("mouseout",function(t){$("#nodeInfoID"+t.id).css("visibility","hidden"),$("#nodeInfoTextID"+t.id).css("visibility","hidden"),c()}),p.append("text").attr("id",function(t){return"nodeInfoTextID"+t.id}).attr("x",B.width/2+Y.textMargin).attr("y",B.height/2+2*Y.textMargin).attr("width",Y.width).attr("height",Y.height).attr("class","tooltip-text").style("fill","white").style("font-size","12px").append("tspan").text(function(t){return"Name: "+t.name}).append("tspan").attr("x",B.width/2+Y.textMargin).attr("dy","1.5em").text(function(t){return"Info: "+t.label});var x=a.transition().duration(E).attr("transform",function(t){return"translate("+t.y+","+t.x+")"});u.transition().duration(E).attr("transform",function(t){return"translate("+t.y+","+t.x+")"}),x.select("rect").attr("class",function(t){return t._children?"node-rect-closed":"node-rect"}),x.select("circle").attr("r",6).style("fill",function(t){return t._children?"black":"#999"}),x.select("text").style("fill-opacity",1);var m=a.exit().transition().duration(E).attr("transform",function(){return"translate("+t.y+","+t.x+")"}).remove();u.exit().transition().duration(E).attr("transform",function(){return"translate("+t.y+","+t.x+")"}).remove(),m.select("text").style("fill-opacity",1e-6),m.select("circle").attr("r",1e-6);var v=I.selectAll("path").data(i,function(t){return t.target.id}),w=D.selectAll("g").data(i,function(t){return t.target.id});d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})};v.enter().insert("path","g").attr("class","link").attr("id",function(t){return"linkID"+t.target.id}).attr("d",function(t){return h(t)}).attr("marker-end","url(#end-arrow)").attr("marker-start",function(t){return e(t.target.link.direction,!1)}).on("mouseover",function(t){d3.select(this).moveToFront(),d3.select(this).attr("marker-end","url(#end-arrow-selected)"),d3.select(this).attr("marker-start",e(t.target.link.direction,!0)),d3.select(this).attr("class","linkselected"),$("#tooltipLinkID"+t.target.id).attr("x",(t.target.y+B.width-t.source.y)/2+t.source.y),$("#tooltipLinkID"+t.target.id).attr("y",(t.target.x-t.source.x)/2+t.source.x),$("#tooltipLinkID"+t.target.id).css("visibility","visible"),$("#tooltipLinkTextID"+t.target.id).css("visibility","visible")}).on("mouseout",function(t){d3.select(this).attr("marker-end","url(#end-arrow)"),d3.select(this).attr("marker-start",e(t.target.link.direction,!1)),d3.select(this).attr("class","link"),$("#tooltipLinkID"+t.target.id).css("visibility","hidden"),$("#tooltipLinkTextID"+t.target.id).css("visibility","hidden")});w.enter().append("rect").attr("id",function(t){return"tooltipLinkID"+t.target.id}).attr("class","tooltip-box").style("fill-opacity",.8).attr("x",function(t){return(t.target.y+B.width-t.source.y)/2+t.source.y}).attr("y",function(t){return(t.target.x-t.source.x)/2+t.source.x}).attr("width",Y.width).attr("height",Y.height).on("mouseover",function(t){$("#tooltipLinkID"+t.target.id).css("visibility","visible"),$("#tooltipLinkTextID"+t.target.id).css("visibility","visible"),$("#linkID"+t.target.id).attr("class","linkselected"),$("#linkID"+t.target.id).attr("marker-end","url(#end-arrow-selected)"),$("#linkID"+t.target.id).attr("marker-start",e(t.target.link.direction,!0)),l()}).on("mouseout",function(t){$("#tooltipLinkID"+t.target.id).css("visibility","hidden"),$("#tooltipLinkTextID"+t.target.id).css("visibility","hidden"),$("#linkID"+t.target.id).attr("class","link"),$("#linkID"+t.target.id).attr("marker-end","url(#end-arrow)"),$("#linkID"+t.target.id).attr("marker-start",e(t.target.link.direction,!1)),c()}),w.enter().append("text").attr("id",function(t){return"tooltipLinkTextID"+t.target.id}).attr("class","tooltip-text").attr("x",function(t){return(t.target.y+B.width-t.source.y)/2+t.source.y+Y.textMargin}).attr("y",function(t){return(t.target.x-t.source.x)/2+t.source.x+2*Y.textMargin}).attr("width",Y.width).attr("height",Y.height).style("fill","white").append("tspan").text(function(t){return r(t.target.link)}).append("tspan").attr("x",function(t){return(t.target.y+B.width-t.source.y)/2+t.source.y+Y.textMargin}).attr("dy","1.5em").text(function(t){return t.target.link.name});v.transition().duration(E).attr("d",function(t){return h(t)});w.transition().duration(E).attr("d",function(t){return h(t)}),v.exit().transition().remove(),w.exit().transition().remove(),n.forEach(function(t){t.x0=t.x,t.y0=t.y})}function a(){var t=1,e=d3.event.translate,r=-A*t,n=A*t,i=(-_+S.right)*t,a=(_-S.left)*t;e=[Math.max(Math.min(e[0],a),i),Math.max(Math.min(e[1],n),r)],d3.select(".drawarea").attr("transform","translate("+e+") scale("+t+")")}function o(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null),i(t)}function s(t,e){var r=0;if(t&&t.length>0){var n=t[0].depth,i=[],a=[];for(i.push(t[0]);i.length>0;){var o=i.shift();if(o.depth>n&&(e(a),n++,r=Math.max(r,a.length),a=[]),a.push(o),o.children)for(var s=0;s<o.children.length;s++)i.push(o.children[s])}return e(a),Math.max(r,a.length)}return 0}function d(t){var e=5;if(t)for(var r=0;r<t.length-1;r++)t[r+1].x-(t[r].x+B.height)<e&&(t[r+1].x=t[r].x+B.height+e)}function l(){x=d3.select("#tree-container").select("svg").on("mousedown.zoom"),d3.select("#tree-container").select("svg").on("mousedown.zoom",null)}function c(){d3.select("#tree-container").select("svg").on("mousedown.zoom",x)}function u(){return d3.select("#tree-container").select("svg").on("wheel.zoom")?(m="wheel.zoom",d3.select("#tree-container").select("svg").on("wheel.zoom")):null!=d3.select("#tree-container").select("svg").on("mousewheel.zoom")?(m="mousewheel.zoom",d3.select("#tree-container").select("svg").on("mousewheel.zoom")):d3.select("#tree-container").select("svg").on("DOMMouseScroll.zoom")?(m="DOMMouseScroll.zoom",d3.select("#tree-container").select("svg").on("DOMMouseScroll.zoom")):void 0}function h(t){var e={x:t.source.x+B.height/2,y:t.source.y+B.width},r={x:t.target.x+B.height/2,y:t.target.y-12},n=(e.y+r.y)/2,i=[e,{x:e.x,y:n},{x:r.x,y:n},r];return"M"+(i=i.map(function(t){return[t.y,t.x]}))[0]+"C"+i[1]+" "+i[2]+" "+i[3]}function f(){var t=M.append("filter").attr("id","drop-shadow").attr("color-interpolation-filters","sRGB");t.append("feOffset").attr("result","offOut").attr("in","SourceGraphic").attr("dx",0).attr("dy",0),t.append("feGaussianBlur").attr("stdDeviation",2),t.append("feOffset").attr("dx",2).attr("dy",2).attr("result","shadow"),t.append("feComposite").attr("in","offOut").attr("in2","shadow").attr("operator","over")}function p(){M.append("marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").attr("class","arrow").append("path").attr("d","M0,-5L10,0L0,5"),M.append("marker").attr("id","end-arrow-selected").attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").attr("class","arrowselected").append("path").attr("d","M0,-5L10,0L0,5"),M.append("marker").attr("id","start-arrow").attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").attr("class","arrow").append("path").attr("d","M10,-5L0,0L10,5"),M.append("marker").attr("id","start-arrow-selected").attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").attr("class","arrowselected").append("path").attr("d","M10,-5L0,0L10,5")}var g,x,m,y,v,w,k,b,I,D,M,L="#337ab7",z="#5cb85c",T="#f0ad4e",O="#9467bd",S={top:0,right:0,bottom:100,left:0},_=800-S.right-S.left,A=400-S.top-S.bottom,B={width:225,height:100,textMargin:7.5},Y={width:150,height:50,textMargin:7.5},C=0,E=750;r(t,e)}